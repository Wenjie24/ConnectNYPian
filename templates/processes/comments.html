{% extends 'base.html' %}
{% block title%}ConnectNYPian{% endblock %}

{% block content %}
{% from "includes/formHelper.html" import render_field %}
<main class="container-fluid w-75" style="max-width: 700px;">
    <div class="bg-light p-4 rounded">
        <img src="/static/images/person-circle.svg" alt="avatar" class="rounded-circle img-fluid" style="width: 30px; float: left; margin-right: 10px">
        <p style="font-size: 20px">{{post.username}}</p>
        <h3>{{post.title}}</h3>
        <p class="lead">
            {{post.body}}
        </p>
        <hr>
        <div class="row">
            {% if post.post_id in liked_posts %}
            <div class="col">
                <button type="button" class="btn btn-outline-primary"><a
                        href="/removelike/{{post.post_id}}">Unlike</a></button>
            </div>
            {% else %}
            <div class="col">
                <button type="button" class="btn btn-outline-primary"><a
                        href="/createlike/{{post.post_id}}">Like</a></button>
            </div>
            {%endif%}
            <div class="col">
                <button type="button" class="btn btn-outline-primary"><a href="/comments/{{post.post_id}}">Comment</a>
                </button>
            </div>
            <div class="col">
                <button type="button" class="btn btn-outline-primary">Share</button>
            </div>
            {% if post.account_id == session['login_id'] %}
            <div class="col">
                <button type="button" class="btn btn-danger"><a href="/deletepost/{{post.post_id}}"
                        style="color: white">Delete</a></button>
            </div>
            {% endif %}
        </div>
    </div>
    <br>
    <hr>
    <br>
    <div class="container-fluid w-75">
        <div class="row justify-content-center">

            <div class="bg-light rounded p-4 col-md-11 col-md-offset-2">

                <h2>Comment</h2>

                <form action="/comments/{{post.post_id}}" method="POST">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                    <div class="form-group has-error">
                        {{ render_field(form.body, class="form-control") }}
                    </div>
                    <br>
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary">
                            Create
                        </button>
                    </div>

                </form>
            </div>

        </div>
    </div>
    <br>
    <br>
    {% for comment in comments %}
      <div class="bg-light p-4 rounded">
        <img src="/static/images/person-circle.svg" alt="avatar" class="rounded-circle img-fluid" style="width: 30px; float: left; margin-right: 10px">
        <p style="font-size: 20px">{{comment.username}}</p>
        <p class="lead">
          {{comment.body}}
        </p>
        <div class="row">
          {% if comment.account_id == session['login_id'] %}
          <div class="col">
            <button type="button" class="btn btn-danger"><a href="/deletecomment/{{post.post_id}}/{{comment.comment_id}}" style="color: white">Delete</a></button>
          </div>
          {% endif %}
        </div>
      </div>
    <br>
    <br>
    {% endfor %}
</main>
{% endblock %}